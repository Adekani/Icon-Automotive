<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Icon Automotive | Redefining Standards</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- GSAP for Cinematic Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <!-- favicon -->
    <link rel="icon" type="image/png" href="logoblk.png">
    
    <style>
        /* Custom Font Setup */
        @font-face {
            font-family: 'Orenburg';
            src: url('Orenburg.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        :root {
            --brand-red: #E60002;
            --brand-dark: #0a0a0a;
            --brand-gray: #1a1a1a;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--brand-dark);
            color: #ffffff;
            overflow-x: hidden;
        }

        .font-heading { font-family: 'Orenburg', serif; }

        /* Animation Classes */
        .hero-anim { opacity: 0; transform: translateY(30px); }
        .reveal-left { transform: translateX(-50px); opacity: 0; }
        .reveal-right { transform: translateX(50px); opacity: 0; }

        /* Glassmorphism */
        .glass-nav {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Hover Effects */
        .btn-primary {
            background-color: var(--brand-red);
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(230, 0, 2, 0.3);
        }

        .car-card {
            transition: all 0.5s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .car-card:hover {
            border-color: var(--brand-red);
            transform: translateY(-10px);
        }

        /* Custom Loader */
        #loader {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }
    </style>
</head>

<body>

    <!-- Loader -->
    <div id="loader">
        <div class="flex flex-col items-center">
            <img src="logoblk.png" alt="Logo" class="w-20 mb-4 animate-pulse">
            <div class="w-48 h-[2px] bg-gray-800 rounded-full overflow-hidden">
                <div id="loader-bar" class="w-0 h-full bg-[#E60002] transition-all duration-1000"></div>
            </div>
        </div>
    </div>

    <!-- Navigation (Placeholder for external component) -->
    <div id="nav-placeholder"></div>

    <!-- Hero Section -->
    <section class="relative h-screen flex items-center justify-center overflow-hidden">
        <!-- Video/Image Background -->
        <div class="absolute inset-0 z-0">
            <div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/20 to-black z-10"></div>
            <img src="https://images.unsplash.com/photo-1618843479313-40f8afb4b4d8?auto=format&fit=crop&q=80&w=2070" 
                 class="w-full h-full object-cover scale-110" alt="Hero Background">
        </div>

        <div class="container mx-auto px-6 relative z-20 text-center">
            <p class="hero-anim text-[#E60002] font-bold tracking-[0.3em] mb-4 uppercase text-sm">Exclusivity. Precision. Power.</p>
            <h1 class="hero-anim font-heading text-6xl md:text-8xl mb-8 tracking-tighter leading-none">
                REDEFINING <br> <span class="text-white/90">STANDARDS</span>
            </h1>
            <div class="hero-anim flex flex-col md:flex-row gap-4 justify-center">
                <a href="catalog.html" class="btn-primary px-10 py-4 font-bold text-sm tracking-widest uppercase">Explore Inventory</a>
                <a href="#about" class="bg-white/5 backdrop-blur-md border border-white/10 px-10 py-4 font-bold text-sm tracking-widest uppercase hover:bg-white/10 transition-all">Our Story</a>
            </div>
        </div>

        <!-- Scroll Indicator -->
        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 z-20 animate-bounce">
            <div class="w-[1px] h-12 bg-gradient-to-b from-[#E60002] to-transparent mx-auto"></div>
        </div>
    </section>

    <!-- Featured Section -->
    <section id="featured" class="py-24 bg-[#050505]">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-end mb-16">
                <div class="gsap-fade-up">
                    <h2 class="font-heading text-4xl mb-2">CURATED SELECTIONS</h2>
                    <p class="text-gray-500 tracking-widest uppercase text-xs">The latest additions to our elite showroom</p>
                </div>
                <a href="catalog.html" class="gsap-fade-up text-sm font-bold border-b-2 border-[#E60002] pb-1 hover:text-[#E60002] transition-colors mt-6 md:mt-0">VIEW FULL CATALOG</a>
            </div>

            <!-- Car Grid -->
            <div id="featured-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Data injected from Supabase -->
            </div>
        </div>
    </section>

    <!-- About Sneak Peak -->
    <section id="about" class="py-24 relative overflow-hidden">
        <div class="container mx-auto px-6 grid md:grid-cols-2 gap-16 items-center">
            <div class="gsap-fade-up">
                <span class="text-[#E60002] font-bold text-xs tracking-widest uppercase">Unmatched Excellence</span>
                <h2 class="font-heading text-5xl mt-4 mb-8 leading-tight">WE DON'T JUST SELL CARS; <br> WE SOURCE DREAMS.</h2>
                <p class="text-gray-400 mb-8 leading-relaxed">
                    Based in the heart of Lagos, Icon Automotive has spent years perfecting the art of luxury vehicle acquisition. 
                    Every car in our inventory undergoes a rigorous 150-point inspection before it reaches our clients.
                </p>
                <div class="flex gap-12">
                    <div>
                        <div class="text-3xl font-heading text-[#E60002]">100%</div>
                        <div class="text-[10px] text-gray-500 uppercase tracking-widest mt-1">Authenticity</div>
                    </div>
                    <div>
                        <div class="text-3xl font-heading text-[#E60002]">500+</div>
                        <div class="text-[10px] text-gray-500 uppercase tracking-widest mt-1">Deliveries</div>
                    </div>
                </div>
            </div>
            <div class="relative gsap-fade-up">
                <img src="https://images.unsplash.com/photo-1503376780353-7e6692767b70?auto=format&fit=crop&q=80&w=2070" 
                     class="rounded-sm shadow-2xl grayscale hover:grayscale-0 transition-all duration-700" alt="Showroom">
                <div class="absolute -bottom-6 -right-6 w-32 h-32 border-r-2 border-b-2 border-[#E60002]"></div>
            </div>
        </div>
    </section>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <script>
        // --- 1. Supabase Setup ---
        const SUPABASE_URL = 'https://dpzvjsfgilnuzedghfww.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRwenZqc2ZnaWxudXplZGdoZnd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1MjUyMTcsImV4cCI6MjA4MzEwMTIxN30.KjnG8hVXcWshG1XIDOrWEnM1ITiLT2Nzu3b1Z1ix-8Q';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // --- 2. Load Components ---
        function loadComponents() {
            fetch('nav.html').then(res => res.text()).then(data => document.getElementById('nav-placeholder').innerHTML = data);
            fetch('footer.html').then(res => res.text()).then(data => document.getElementById('footer-placeholder').innerHTML = data);
        }

        // --- 3. Load Featured Cars from Supabase ---
        async function loadFeaturedCars() {
            const container = document.getElementById('featured-grid');
            
            try {
                // Fetch top 3 latest cars from Supabase
                const { data: cars, error } = await supabase
                    .from('cars')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(3);

                if (error) throw error;

                if (!cars || cars.length === 0) {
                    container.innerHTML = `<p class="col-span-3 text-center text-gray-500 py-10">New inventory arriving soon...</p>`;
                    return;
                }

                container.innerHTML = ""; // Clear loader
                
                cars.forEach(car => {
                    const firstImage = car.images && car.images.length > 0 ? car.images[0] : 'placeholder.jpg';
                    const card = `
                        <div class="car-card bg-[#111] rounded-sm overflow-hidden group gsap-fade-up">
                            <div class="relative overflow-hidden aspect-[4/3]">
                                <img src="${firstImage}" alt="${car.brand}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                                <div class="absolute top-4 left-4">
                                    <span class="bg-[#E60002] text-white text-[10px] font-bold uppercase px-3 py-1 tracking-widest">
                                        ${car.usage_state}
                                    </span>
                                </div>
                            </div>
                            <div class="p-8">
                                <div class="flex justify-between items-start mb-4">
                                    <div>
                                        <h3 class="font-heading text-2xl mb-1">${car.brand} ${car.model}</h3>
                                        <p class="text-xs text-gray-500 uppercase tracking-[0.2em]">${car.year} • ${car.location}</p>
                                    </div>
                                    <div class="text-[#E60002] font-bold">₦${car.price.toLocaleString()}</div>
                                </div>
                                <a href="car.html?id=${car.id}" class="inline-block w-full text-center py-4 border border-white/10 text-[10px] font-bold tracking-[0.3em] uppercase hover:bg-white hover:text-black transition-all">
                                    View Details
                                </a>
                            </div>
                        </div>
                    `;
                    container.innerHTML += card;
                });

            } catch (error) {
                console.error("Error loading cars from Supabase:", error);
                container.innerHTML = `<p class="col-span-3 text-center text-red-500">Failed to load inventory.</p>`;
            }
        }

        // --- 4. Animations & Init ---
        window.addEventListener('load', () => {
            loadComponents();
            loadFeaturedCars();

            // Progress bar simulation
            document.getElementById('loader-bar').style.width = '100%';

            setTimeout(() => {
                document.getElementById('loader').style.opacity = '0';
                setTimeout(() => document.getElementById('loader').style.display = 'none', 500);
                
                // Hero Anims
                gsap.to(".hero-anim", {
                    y: 0,
                    opacity: 1,
                    duration: 1.2,
                    stagger: 0.2,
                    ease: "power3.out"
                });

                // Scroll Anims
                gsap.registerPlugin(ScrollTrigger);
                gsap.utils.toArray('.gsap-fade-up').forEach(element => {
                    gsap.fromTo(element, 
                        { y: 50, opacity: 0 },
                        {
                            y: 0, opacity: 1, duration: 1,
                            scrollTrigger: {
                                trigger: element,
                                start: "top 85%",
                            }
                        }
                    );
                });
            }, 1000);
        });
    </script>
</body>
</html>
